<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    <title>Redirecting...</title>
    <script>
      // GitHub Pages 404 redirect with SPA support
      // Get the repository name from the pathname (for GitHub Pages)
      var repo = location.pathname.split('/')[1];
      var basePath = location.pathname.indexOf('/' + repo) === 0 ? '/' + repo : '';
      
      // Redirect to index.html preserving the path
      var path = window.location.pathname;
      if (basePath && path.indexOf(basePath) === 0) {
        path = path.substring(basePath.length);
      }
      path = path.replace('/404.html', '') || '/';
      
      // Build the redirect URL
      var redirectTo = basePath + path + window.location.search + window.location.hash;
      
      // This page will register a service worker that adds COOP/COEP headers
      if ('serviceWorker' in navigator) {
        // Register the service worker
        window.addEventListener('load', function() {
          navigator.serviceWorker.register(basePath + '/sw.js').then(function(registration) {
            console.log('Service Worker registered with scope:', registration.scope);
            // After registration, redirect to the original URL
            window.location.href = redirectTo;
          }).catch(function(error) {
            console.error('Service Worker registration failed:', error);
            // Still redirect even if service worker fails
            window.location.href = redirectTo;
          });
        });
      } else {
        // If service workers are not supported, just redirect
        window.location.href = redirectTo;
      }
    </script>
  </head>
  <body>
    <h1>Redirecting to the application...</h1>
    <p>If you are not redirected automatically, <a href="/">click here</a>.</p>
  </body>
</html> 